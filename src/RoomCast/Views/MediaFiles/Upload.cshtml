@model RoomCast.Models.ViewModels.FileUploadViewModel
@{
    ViewData["Title"] = "Upload File";
}

@section Styles {
    <link rel="stylesheet" href="~/css/media-upload.css" asp-append-version="true" />
}

<h2>Upload File</h2>

<form asp-action="Upload" method="post" enctype="multipart/form-data">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div id="fileDropZone"
         class="upload-dropzone"
         data-allowed-extensions="@System.Text.Json.JsonSerializer.Serialize(Model.AllowedExtensionsByType)">
        <span class="icon">⬆️</span>
        <strong>Drag &amp; drop</strong> a picture, video, or document here<br />
    <small class="text-muted">…or click to browse your files</small>
    <input asp-for="File" id="fileInput" type="file" class="d-none" accept="@string.Join(",", Model.AllowedExtensions)" />
    </div>
    <span asp-validation-for="File" class="text-danger"></span>

    <div id="previewContainer" class="upload-preview d-none">
        <div class="preview-label">Selected File Preview</div>
        <div id="previewContent"></div>
    </div>

    <div class="upload-file-info">
        <div class="form-group">
            <label asp-for="Title"></label>
            <input asp-for="Title" class="form-control" placeholder="auto-filled from the selected file" />
            <span asp-validation-for="Title" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label>Detected Type</label>
            <input type="text" id="detectedType" class="form-control" readonly placeholder="Select a file to detect type" />
        </div>
    </div>

    <div class="form-group">
        <label asp-for="Tags"></label>
        <input asp-for="Tags" class="form-control" />
        <small class="form-text text-muted">Optional: separate multiple tags with commas.</small>
        <span asp-validation-for="Tags" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary">Upload</button>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script src="~/js/media-upload.js" asp-append-version="true"></script>
}
